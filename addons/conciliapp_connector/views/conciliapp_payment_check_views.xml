<odoo>
  <!-- TREE -->
  <record id="view_conciliapp_payment_check_tree" model="ir.ui.view">
    <field name="name">conciliapp.payment.check.tree</field>
    <field name="model">conciliapp.payment.check</field>
    <field name="arch" type="xml">
      <tree>
        <field name="create_date" string="Creado" />
        <field name="reference" />
        <field name="amount" />
        <field name="bank_id" />
        <field name="status" />
        <field name="reconciled_at" />
      </tree>
    </field>
  </record>

  <!-- FORM -->
  <record id="view_conciliapp_payment_check_form" model="ir.ui.view">
    <field name="name">conciliapp.payment.check.form</field>
    <field name="model">conciliapp.payment.check</field>
    <field name="arch" type="xml">
      <form string="Validación de pago">
        <header>
          <button name="action_validate_payment" string="Validar en Conciliapp"
            type="object" class="btn-primary"
            attrs="{'invisible': [('status', '=', 'reconciled')]}" />
          <field name="status" widget="statusbar"
            statusbar_visible="pending,failed,reconciled" />
        </header>

        <sheet>
          <group>
            <field name="reference" />
            <field name="amount" />
            <field name="bank_id" />
          </group>

          <group string="Resultado">
            <field name="api_message" readonly="1" />
            <field name="reconciled_at" readonly="1" />
            <field name="api_payload" readonly="1" widget="text" />
          </group>
        </sheet>
      </form>
    </field>
  </record>

  <!-- ACTION: vista principal = conciliados -->
  <record id="conciliapp_payment_check_action_reconciled"
    model="ir.actions.act_window">
    <field name="name">Pagos conciliados</field>
    <field name="res_model">conciliapp.payment.check</field>
    <field name="view_mode">tree,form</field>
    <field name="domain">[('status','=','reconciled')]</field>
    <field name="context">{'search_default_reconciled': 1}</field>
  </record>

  <!-- ACTION: pendientes (opcional, pero útil para operar) -->
  <record id="conciliapp_payment_check_action_pending"
    model="ir.actions.act_window">
    <field name="name">Validar pagos</field>
    <field name="res_model">conciliapp.payment.check</field>
    <field name="view_mode">tree,form</field>
    <field name="domain">[('status','!=','reconciled')]</field>
  </record>

</odoo>
